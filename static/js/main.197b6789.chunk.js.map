{"version":3,"sources":["providers/MuiPickersUtilsProvider.tsx","redux/features/user.ts","lib/age.ts","hooks/useUser.tsx","components/organisms/ProfileCard.tsx","lib/uuid.ts","constants/fullcalendar/settings.ts","lib/date.ts","core/event/BaseEvent.ts","core/resource/BaseResource.ts","core/story/BaseStory.ts","constants/fullcalendar/templates.ts","core/resource/createProfileResources.ts","core/event/createProfileEvents.ts","constants/visa.ts","redux/features/userCalendars.ts","hooks/useUserCalendar.ts","core/calendar/UserCalendar/createUserCalendar.ts","core/story/ProfileStory/createProfileStory.ts","hooks/useStory.tsx","constants/fullcalendar/options.ts","components/atoms/BaseFullCalendar.tsx","components/atoms/BaseCalendarContainer.tsx","hooks/useResourceGroupLabelContentInUserCalendar.tsx","redux/ui/resourceModal.ts","redux/ui/storyModal.ts","redux/ui/eventModal.ts","hooks/useResource.tsx","components/molecules/ResourceModal.tsx","components/molecules/StoryModal.tsx","hooks/useEvent.tsx","components/molecules/EventModal.tsx","components/molecules/UserCalendarContainer.tsx","hooks/useResourceModal.tsx","hooks/useStoryModal.tsx","hooks/useEventModal.tsx","core/calendar/CommunityCollegeCalendar/model.ts","core/story/CommunityCollegeStory/build.ts","core/calendar/CommunityCollegeCalendar/createCalendar.ts","constants/school.ts","lib/util.ts","redux/features/templateCalendarTable.ts","components/molecules/TemplateCalendarContainer.tsx","hooks/useCommunityCollegeCalendar.tsx","hooks/useResourceGroupLabelContentInTemplateCalendar.tsx","hooks/useModal.tsx","components/organisms/CalendarList.tsx","components/atoms/LogoImage.tsx","components/molecules/Footer.tsx","components/atoms/AboutModal.tsx","components/molecules/Header.tsx","components/pages/CalendarPage.tsx","App.tsx","reportWebVitals.ts","redux/rootReducer.ts","redux/store.ts","providers/ReactReduxProvider.tsx","index.tsx"],"names":["MuiPickersUtilsProvider","children","utils","DateFnsUtils","personaBirth","addYears","Date","toISOString","userSlice","createSlice","name","initialState","birthday","age","canWorkingholiday","reducers","updateBirthday","state","action","payload","_birthday","today","birthDate","getFullYear","m","getMonth","getDate","calcAge","toggleWorkingholiday","_action","actions","updateBirthdayAction","toggleWorkingholidayAction","selectUser","features","user","useUser","dispatch","useDispatch","setBirth","React","useCallback","birth","useSelector","ProfileCard","handleDateChange","date","handleToggleWorkingholiday","_Card","Avatar","alt","TextField","id","label","disabled","InputProps","readOnly","InputLabelProps","shrink","type","value","DatePicker","disableFuture","openTo","format","views","onChange","Checkbox","checked","styled","Card","uuid","uuidV4","FIELD1","FIELD2","NAME_OF_STORY_ID","NAME_OF_ORDER","MY_CALENDAR_ID","RESOURCE_ID__SHARED__AGE","RESOURCE_ID__SHARED__LIMIT","convertIsoToDateTime","isoStr","split","initEvent","props","calendarId","_resourceId","resourceId","_storyId","storyId","_title","title","start","end","extendedProps","initResource","createStoryName","replace","DARK_BLUE","FIELD__H1__VISA","FIELD__H1__STATUS","RESOURCE_TEMPLATE__VISA_STUDY","RESOURCE_TEMPLATE__VISA_COOP","RESOURCE_TEMPLATE__WORKING_HOLIDAY_COOP","RESOURCE_TEMPLATE__STUDENT_STATUS","RESOURCE_TEMPLATE__WORKER_STATUS","createProfileResources","createProfileEvents","startDate","years","list","i","push","getRangeNumbers","getLastYear","workingHolidayLimitEvents","createWorkingHolidayLimitEvents","ageEventList","map","year","index","setFullYear","addMonths","lastYearDate","endDate","endOfLimit","endOfApplication","setMonth","userCalendarsSlice","calendars","updateCalendars","pushResource","resource","calendarIdx","findIndex","calendar","console","warn","storyIdx","stories","story","resources","updateResource","newResource","resourceIdx","removeResource","filter","addStory","idx","removeStory","updateStory","newStory","addEvent","event","events","removeEvent","eventId","_event","updateEvent","newEvent","eventIdx","updateCalendarsAction","pushResourceAction","updateResourceAction","removeResourceAction","addStoryAction","removeStoryAction","updateStoryAction","addEventAction","removeEventAction","updateEventAction","selectUserCalendar","userCalendars","useUserCalendar","init","_birth","createProfileStory","_calendar","select","info","startStr","endStr","useMemo","flatMap","useStory","remove","window","confirm","update","idSet","data","params","create","_calendarId","initStory","MY_TIME_LINE_NAME","headerToolbar","left","center","right","initialView","resourceGroupField","duration","buttonText","resourceConfigs","resourceOrder","resourcesInitiallyExpanded","FULL_CALENDAR_CONFIGS","slotLabelFormat","month","schedulerLicenseKey","nowIndicator","BaseFullCalendar","plugins","interactionPlugin","resourceTimelinePlugin","listPlugin","BaseCalendarContainer","slice","_payload","pop","selectIsOpen","ui","resourceModal","selectResourceModal","selectResource","_resource","find","pushAction","popAction","storyModal","selectStoryModal","selectStory","_story","eventModal","selectEventModal","selectEvent","useResource","_resources","lastResource","order","length","_order","field1","field2","Object","assign","undefined","ResourceModal","isOpen","onClose","onRemove","onUpdate","useForm","register","handleSubmit","Dialog","open","DialogTitle","DialogContent","dividers","onSubmit","ref","defaultValue","onClick","StoryModal","handleRemove","handleAddResource","useEvent","EventModal","ableConfis","selectable","editable","UserCalendarContainer","useResourceModal","pushResourceModal","popResourceModal","isOpenResourceModal","useStoryModal","pushStoryModal","popStoryModal","isOpenStoryModal","useEventModal","popEventModal","isOpenEventModal","resourceGroupLabelContent","createOpenHandle","groupValue","openHandle","nameElement","document","createElement","innerHTML","buttonElement","onclick","domNodes","useResourceGroupLabelContentInUserCalendar","pushStoryModalAction","initUserCalendar","createStory","handleCreateStory","click","pushEventModalAction","useEffect","resourceAreaColumns","field","headerContent","cellContent","arg","message","fieldValue","containerEl","buttonEl","appendChild","messageEl","eventClick","initialDate","VISA_BACKGROUND_COLOR","STATUS_BACKGROUND_COLOR","generateStory","coopVisaResourceId","studyVisaResourceId","workingholidayResourceId","dateAsStartWorkingHoliday","workerStatusResourceId","studentStatusResourceId","startMonths","addingNumbers","stop","step","a","b","range","generateStoryList","num","build","templateCalendarTable","CommunityCollegeCalendarId","upsertCommunityCollegeStories","createCalendar","upsertCommunityCollegeStoriesAction","selectCommunityCollegeCalendar","templateCalendar","TemplateCalendarContainer","generate","reduce","prev","useCommunityCollegeCalendar","createClickHandel","clickHandle","useResourceGroupLabelContentInTemplateCalendar","useModal","useState","setIsOpen","close","toggle","CalendarList","openCommunityCollege","closeCommunityCollege","isOpenCommunityCollege","Container","fullScreen","div","LogoImage","Img","src","img","Footer","LogoText","LogoImageContainer","href","target","rel","AboutModal","Typography","Header","Title","ButtonContainer","Button","span","CalendarPage","ContentWrapper","App","className","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","uiReducer","combineReducers","resourceModalReducer","storyModalReducer","eventModalReducer","featuresReducer","templateCalendarTableReducer","userCalendarsReducer","userReducer","rootReducer","store","configureStore","reducer","ReactReduxProvider","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.197b6789.chunk.js","sourcesContent":["import React, { PropsWithChildren } from \"react\";\nimport { MuiPickersUtilsProvider as RawMuiPickersUtilsProvider } from \"@material-ui/pickers\";\nimport DateFnsUtils from \"@date-io/date-fns\";\n\nexport function MuiPickersUtilsProvider<T>({ children }: PropsWithChildren<T>) {\n  return (\n    <RawMuiPickersUtilsProvider utils={DateFnsUtils}>\n      {children}\n    </RawMuiPickersUtilsProvider>\n  );\n}\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { calcAge } from \"../../lib/age\";\nimport { addYears } from \"date-fns\";\nimport { RootState } from \"../rootReducer\";\n\nconst PERSONA_AGE = 25;\nconst personaBirth = addYears(new Date(), -PERSONA_AGE).toISOString();\n\ntype UpdatePayload = {\n  birthday: string;\n};\n\nconst userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    birthday: personaBirth,\n    age: PERSONA_AGE,\n    canWorkingholiday: true,\n  },\n  reducers: {\n    updateBirthday(state, action: PayloadAction<UpdatePayload>) {\n      const { birthday } = action.payload;\n      state.birthday = birthday;\n      state.age = calcAge(birthday);\n    },\n    toggleWorkingholiday(state, _action: PayloadAction<undefined>) {\n      state.canWorkingholiday = !state.canWorkingholiday;\n    },\n  },\n});\n\nexport const {\n  updateBirthday: updateBirthdayAction,\n  toggleWorkingholiday: toggleWorkingholidayAction,\n} = userSlice.actions;\n\nexport default userSlice.reducer;\n\nexport const selectUser = (state: RootState) => state.features.user;\n","export const getRangeNumbers = (start: number, end: number) => {\n  let list = [] as number[];\n  for (let i = start; i <= end; i++) {\n    list.push(i);\n  }\n  return list;\n};\n\n// REF: https://stackoverflow.com/a/7091965/8842333\nexport const calcAge = (_birthday: string | Date) => {\n  const today = new Date();\n  const birthDate = new Date(_birthday);\n  let age = today.getFullYear() - birthDate.getFullYear();\n\n  const m = today.getMonth() - birthDate.getMonth();\n  if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {\n    age--;\n  }\n  return age;\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport {\n  updateBirthdayAction,\n  selectUser,\n  toggleWorkingholidayAction,\n} from \"../redux/features/user\";\n\nexport const useUser = () => {\n  const dispatch = useDispatch();\n\n  const setBirth = React.useCallback(\n    (birth: string) => dispatch(updateBirthdayAction({ birthday: birth })),\n    [dispatch]\n  );\n\n  const toggleWorkingholiday = React.useCallback(() => {\n    dispatch(toggleWorkingholidayAction());\n  }, [dispatch]);\n\n  const { birthday, age, canWorkingholiday } = useSelector(selectUser);\n\n  return {\n    birth: birthday,\n    age,\n    setBirth,\n    toggleWorkingholiday,\n    canWorkingholiday\n  } as const;\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { DatePicker } from \"@material-ui/pickers\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Card from \"@material-ui/core/Card\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\n\nimport { useUser } from \"../../hooks/useUser\";\n\nexport function ProfileCard() {\n  const {\n    birth,\n    age,\n    setBirth,\n    toggleWorkingholiday,\n    canWorkingholiday,\n  } = useUser();\n\n  const handleDateChange = React.useCallback(\n    (date: Date | null) => {\n      if (!date) return;\n      setBirth(date.toISOString());\n    },\n    [setBirth]\n  );\n\n  const handleToggleWorkingholiday = React.useCallback(() => {\n    toggleWorkingholiday();\n  }, [toggleWorkingholiday]);\n\n  return (\n    <_Card>\n      <Avatar alt=\"you\" />\n      <TextField\n        id=\"age-text\"\n        label=\"Your Age\"\n        disabled\n        InputProps={{\n          readOnly: true,\n        }}\n        InputLabelProps={{\n          shrink: true,\n        }}\n        type=\"number\"\n        value={age}\n      />\n      <DatePicker\n        disableFuture\n        openTo=\"year\"\n        format=\"yyyy-MM-dd\"\n        label=\"Date of birth\"\n        views={[\"year\", \"month\", \"date\"]}\n        value={birth}\n        onChange={handleDateChange}\n      />\n      <div>\n        <span>with working holiday</span>\n        <Checkbox\n          checked={canWorkingholiday}\n          onChange={handleToggleWorkingholiday}\n        />\n      </div>\n    </_Card>\n  );\n}\n\nconst _Card = styled(Card)`\n  display: flex;\n  gap: 1rem;\n  padding: 2rem;\n`;\n","import { v4 as uuidV4 } from \"uuid\";\n\nexport function uuid() {\n  return uuidV4();\n}\n","// field name\nexport const FIELD1 = \"FIELD1\";\nexport const FIELD2 = \"FIELD2\";\n\n// keys\nexport const NAME_OF_STORY_ID = \"storyId\";\nexport const NAME_OF_ORDER = \"order\";\nexport const RESOURCE_NAME_KEY = \"RESOURCE_NAME_KEY\";\n\n// calendar ID\nexport const MY_CALENDAR_ID = \"MY_CALENDAR_ID\";\nexport const COMMUNITY_COLLEGE_CALENDAR_ID = \"COMMUNITY_COLLEGE\";\n\n// story ID\nexport const PROFILE_ID = \"PROFILE_ID\";\n\n// resouce ID\nexport const RESOURCE_ID__SHARED__AGE = \"RESOURCE_ID__SHARED__AGE\";\nexport const RESOURCE_ID__SHARED__LIMIT = \"RESOURCE_ID__SHARED__LIMIT\";\nexport const RESOURCE_ID__VISA__STUDY = \"RESOURCE_ID__VISA__STUDY\";\nexport const RESOURCE_ID__VISA__COOP = \"RESOURCE_ID__VISA__COOP\";\nexport const RESOURCE_ID__VISA__WORKING_HOLIDAY =\n  \"RESOURCE_ID__VISA__WORKING_HOLIDAY\";\nexport const RESOURCE_ID__STATUS__WORKER = \"RESOURCE_ID__STATUS__WORKER\";\nexport const RESOURCE_ID__STATUS__STUDENT = \"RESOURCE_ID__STATUS__STUDENT\";\nexport const RESOURCE_ID__ETC__CUSTOM = \"RESOURCE_ID__ETC__CUSTOM\";\nexport type RESOURCE_ID =\n  | typeof RESOURCE_ID__SHARED__AGE\n  | typeof RESOURCE_ID__SHARED__LIMIT\n  | typeof RESOURCE_ID__VISA__STUDY\n  | typeof RESOURCE_ID__VISA__COOP\n  | typeof RESOURCE_ID__VISA__WORKING_HOLIDAY\n  | typeof RESOURCE_ID__STATUS__WORKER\n  | typeof RESOURCE_ID__STATUS__STUDENT\n  | typeof RESOURCE_ID__ETC__CUSTOM;\n","export const convertIsoToDateTime = (isoStr: string) => isoStr.split(\"T\")[0];\n\nexport const convertIsoToYearAndMonth = (isoStr: string) =>\n  convertIsoToDateTime(isoStr).replace(/-[0-9][0-9]$/, \"\");\n","import { EventInput } from \"@fullcalendar/react\";\nimport { uuid } from \"../../lib/uuid\";\n\nexport type BaseEvent = EventInput & {\n  extendedProps: {\n    calendarId: string;\n    storyId: string;\n  };\n};\n\nexport const initEvent = (props?: Partial<BaseEvent>): BaseEvent => {\n  const {\n    id,\n    calendarId,\n    resourceId: _resourceId,\n    storyId: _storyId,\n    title: _title,\n    start,\n    end,\n  } = props ?? {};\n\n  const storyId = _storyId ?? uuid();\n  const resourceId = _resourceId ?? uuid();\n  const title = _title ?? \"New Event\";\n\n  return {\n    id: id ?? uuid(),\n    resourceId,\n    storyId,\n    title,\n    start: start ?? new Date().toISOString(),\n    end: end ?? new Date().toISOString(),\n    extendedProps: {\n      calendarId,\n      storyId,\n      resourceId,\n    },\n  };\n};\n\nexport const updateEvent = (\n  event: BaseEvent,\n  params: Partial<Omit<BaseEvent, \"id\" | \"storyId\">>\n): BaseEvent => {\n  const title = params.title;\n  const newEvent = Object.assign(\n    { ...event },\n    title !== undefined && { title }\n  );\n\n  return newEvent;\n};\n","import { uuid } from \"../../lib/uuid\";\nimport {\n  NAME_OF_ORDER,\n  NAME_OF_STORY_ID,\n  FIELD1,\n  FIELD2,\n} from \"../../constants/fullcalendar/settings\";\n\nexport type BaseResource = {\n  id: string;\n  calendarId: string;\n  [FIELD1]: string;\n  [FIELD2]: string;\n  [NAME_OF_STORY_ID]: string;\n  [NAME_OF_ORDER]?: number;\n  eventBorderColor?: string;\n};\n\nexport const initResource = (props?: Partial<BaseResource>): BaseResource => {\n  const { id, calendarId, storyId } = props ?? {};\n  return {\n    id: id ?? uuid(),\n    calendarId: calendarId ?? uuid(),\n    [NAME_OF_STORY_ID]: storyId ?? uuid(),\n    [NAME_OF_ORDER]: 1,\n    [FIELD1]: \"Field1\",\n    [FIELD2]: \"Field2\",\n  };\n};\n\nexport const updateResource = (\n  resource: BaseResource,\n  params: Partial<Omit<BaseResource, \"id\" | \"storyId\">>\n): BaseResource => {\n  const order = params[NAME_OF_ORDER];\n  const field1 = params[FIELD1];\n  const field2 = params[FIELD2];\n\n  const orderKey = NAME_OF_ORDER;\n  const field1Key = FIELD1;\n  const field2Key = FIELD2;\n\n  const newResource = Object.assign(\n    { ...resource },\n    order !== undefined && { [orderKey]: order },\n    field1 !== undefined && { [field1Key]: field1 },\n    field2 !== undefined && { [field2Key]: field2 }\n  );\n\n  return newResource;\n};\n","import { convertIsoToYearAndMonth } from \"../../lib/date\";\nimport { BaseEvent, initEvent } from \"../event/BaseEvent\";\nimport { BaseResource, initResource } from \"../resource/BaseResource\";\nimport { uuid } from \"../../lib/uuid\";\n\nexport type BaseStory = {\n  id: string;\n  calendarId: string;\n  events: BaseEvent[];\n  resources: BaseResource[];\n  name: string;\n};\n\nexport const removeEvent = (story: BaseStory, eventId: string): BaseStory => {\n  const newEvents = story.events.filter((event) => event.id !== eventId);\n  return { ...story, events: newEvents };\n};\n\nexport const createStoryName = (birth: Date) => {\n  return \"from \" + convertIsoToYearAndMonth(birth.toISOString());\n};\n\nexport const initStory = (props?: Partial<BaseStory>): BaseStory => {\n  const { id, calendarId: _calendarId, events, resources, name } = props ?? {};\n\n  const storyId = id ?? uuid();\n  const calendarId = _calendarId ?? uuid();\n  const eventId = uuid();\n  const _events = events ?? [initEvent({ id: eventId, storyId })];\n  const _resources = resources ?? [initResource({ calendarId, storyId })];\n\n  return {\n    id: storyId,\n    calendarId,\n    events: _events,\n    resources: _resources,\n    name: name ?? \"No Name\",\n  };\n};\n\nexport const updateStory = (story: BaseStory, params: Partial<BaseStory>) => {\n  return { ...story, ...params };\n};\n","import { FIELD1, FIELD2 } from \"./settings\";\n\nexport const DARK_BLUE = \"#00008b\";\n\nconst FIELD__H1__VISA = \"VISA\";\nconst FIELD__H1__STATUS = \"STATUS\";\n\nexport const RESOURCE_TEMPLATE__VISA_STUDY = {\n  [FIELD1]: FIELD__H1__VISA,\n  [FIELD2]: \"Study VISA\",\n  eventBorderColor: DARK_BLUE,\n};\n\nexport const RESOURCE_TEMPLATE__VISA_COOP = {\n  [FIELD1]: FIELD__H1__VISA,\n  [FIELD2]: \"Co-op VISA\",\n  eventBorderColor: DARK_BLUE,\n};\n\nexport const RESOURCE_TEMPLATE__WORKING_HOLIDAY_COOP = {\n  [FIELD1]: FIELD__H1__VISA,\n  [FIELD2]: \"Working Holiday VISA\",\n  eventBorderColor: DARK_BLUE,\n};\n\nexport const RESOURCE_TEMPLATE__STUDENT_STATUS = {\n  [FIELD1]: FIELD__H1__STATUS,\n  [FIELD2]: \"Student\",\n  eventBorderColor: DARK_BLUE,\n};\n\nexport const RESOURCE_TEMPLATE__WORKER_STATUS = {\n  [FIELD1]: FIELD__H1__STATUS,\n  [FIELD2]: \"Worker\",\n  eventBorderColor: DARK_BLUE,\n};\n","import { DARK_BLUE } from \"../../constants/fullcalendar/templates\";\nimport {\n  FIELD1,\n  FIELD2,\n  NAME_OF_STORY_ID,\n  NAME_OF_ORDER,\n} from \"../../constants/fullcalendar/settings\";\nimport {\n  // PROFILE_ID,\n  RESOURCE_ID__SHARED__AGE,\n  RESOURCE_ID__SHARED__LIMIT,\n} from \"../../constants/fullcalendar/settings\";\nimport { BaseResource } from \"./BaseResource\";\n\nexport const createProfileResources = ({\n  calendarId,\n  storyId,\n}: {\n  calendarId: string;\n  storyId: string;\n}): BaseResource[] => [\n  {\n    id: RESOURCE_ID__SHARED__AGE,\n    [FIELD1]: \"\",\n    [FIELD2]: \"Age\",\n    [NAME_OF_STORY_ID]: storyId,\n    [NAME_OF_ORDER]: 0,\n    calendarId,\n    eventBorderColor: DARK_BLUE,\n  },\n  {\n    id: RESOURCE_ID__SHARED__LIMIT,\n    [FIELD1]: \"\",\n    [FIELD2]: \"Working Holiday Application Limit\",\n    [NAME_OF_STORY_ID]: storyId,\n    [NAME_OF_ORDER]: 1,\n    calendarId,\n    eventBorderColor: DARK_BLUE,\n  },\n];\n","import { addMonths, addYears, setMonth } from \"date-fns\";\n\nimport {\n  RESOURCE_ID__SHARED__AGE,\n  RESOURCE_ID__SHARED__LIMIT,\n} from \"../../constants/fullcalendar/settings\";\nimport { getRangeNumbers } from \"../../lib/age\";\nimport { uuid } from \"../../lib/uuid\";\nimport { convertIsoToDateTime } from \"../../lib/date\";\nimport { WORKING_HOLIDAY_APPLICATION_LIMITATION_AGE } from \"../../constants/visa\";\nimport { BaseEvent } from \"../event/BaseEvent\";\n\nexport const createProfileEvents = ({\n  startDate,\n  storyId,\n  calendarId,\n}: {\n  startDate: Date;\n  storyId: string;\n  calendarId: string;\n}): BaseEvent[] => {\n  // get year num\n  const startYear = new Date(startDate).getFullYear();\n  const endYear = getLastYear();\n\n  // create years list\n  const years = getRangeNumbers(startYear, endYear);\n\n  const workingHolidayLimitEvents = createWorkingHolidayLimitEvents(\n    startDate,\n    storyId,\n    calendarId\n  );\n\n  // create EventInput obj\n  const ageEventList = years.map((year, index) => {\n    const start = (() => {\n      startDate.setFullYear(year);\n      const isoStr = startDate.toISOString();\n      const str = convertIsoToDateTime(isoStr);\n      return str;\n    })();\n\n    const isoStr = addMonths(new Date(start), +11).toISOString();\n    const end = convertIsoToDateTime(isoStr);\n\n    return {\n      id: uuid(),\n      title: `Aage:${index}`,\n      start,\n      end,\n      storyId,\n      resourceId: RESOURCE_ID__SHARED__AGE,\n      extendedProps: {\n        resourceId: RESOURCE_ID__SHARED__AGE,\n        calendarId,\n        storyId,\n      },\n    };\n  });\n\n  return [...workingHolidayLimitEvents, ...ageEventList];\n};\n\nconst getLastYear = () => {\n  const BUFFER_YEAR = 10;\n  const date = new Date();\n  return addYears(date, BUFFER_YEAR).getFullYear();\n};\n\nconst createWorkingHolidayLimitEvents = (\n  birthday: Date,\n  storyId: string,\n  calendarId: string\n): BaseEvent[] => {\n  const lastYearDate = addYears(\n    birthday,\n    WORKING_HOLIDAY_APPLICATION_LIMITATION_AGE\n  );\n  const start = convertIsoToDateTime(birthday.toISOString());\n  const endDate = addMonths(lastYearDate, +11);\n  const endOfLimit = convertIsoToDateTime(endDate.toISOString());\n  const endOfApplication = convertIsoToDateTime(\n    addYears(setMonth(endDate, +6), -1).toISOString()\n  );\n\n  const limitation = {\n    id: uuid(),\n    title: \"Limitation till WorkingHoliday\",\n    start,\n    end: endOfLimit,\n    resourceId: RESOURCE_ID__SHARED__LIMIT,\n    storyId,\n    extendedProps: {\n      resourceId: RESOURCE_ID__SHARED__LIMIT,\n      storyId,\n      calendarId,\n    },\n  };\n\n  const application = {\n    id: uuid(),\n    title: \"Application Limit\",\n    start,\n    end: endOfApplication,\n    storyId,\n    resourceId: RESOURCE_ID__SHARED__LIMIT,\n    extendedProps: {\n      storyId,\n      resourceId: RESOURCE_ID__SHARED__LIMIT,\n      calendarId,\n    },\n  };\n  return [limitation, application];\n};\n","// working holiday have to be applied by age of 31.\nexport const WORKING_HOLIDAY_APPLICATION_LIMITATION_AGE = 31;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../rootReducer\";\nimport { BaseCalendar } from \"../../core/calendar/BaseCalendar\";\nimport { BaseStory } from \"../../core/story/BaseStory\";\nimport { BaseEvent } from \"../../core/event/BaseEvent\";\nimport { BaseResource } from \"../../core/resource/BaseResource\";\n\ntype Calendar = BaseCalendar;\ntype UpdateCalendarsPayload = { calendars: Calendar[] };\ntype PushRsourceAction = {\n  calendarId: string;\n  storyId: string;\n  resource: BaseResource;\n};\ntype UpdateResourcePayload = {\n  calendarId: string;\n  storyId: string;\n  newResource: BaseResource;\n};\ntype RemoveResourcePayload = {\n  calendarId: string;\n  storyId: string;\n  resourceId: string;\n};\ntype AddStoryPayload = { calendarId: string; story: BaseStory };\ntype RemoveStoryPayload = { calendarId: string; storyId: string };\ntype UpdateStoryPayload = {\n  calendarId: string;\n  storyId: string;\n  newStory: BaseStory;\n};\ntype AddEventPayload = {\n  calendarId: string;\n  storyId: string;\n  event: BaseEvent;\n};\ntype RemoveEventPayload = {\n  calendarId: string;\n  storyId: string;\n  eventId: string;\n};\ntype UpdateEventPayload = {\n  calendarId: string;\n  storyId: string;\n  eventId: string;\n  newEvent: BaseEvent;\n};\n\nconst userCalendarsSlice = createSlice({\n  name: \"userCalendars\",\n  initialState: {\n    calendars: [] as Calendar[],\n  },\n  reducers: {\n    updateCalendars(state, action: PayloadAction<UpdateCalendarsPayload>) {\n      const { calendars } = action.payload;\n      state.calendars = calendars;\n    },\n    pushResource(state, action: PayloadAction<PushRsourceAction>) {\n      const { calendarId, storyId, resource } = action.payload;\n\n      // calendar\n      const calendarIdx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFind = calendarIdx === -1;\n      if (cannotFind) {\n        console.warn(\"cannot find calendar on updateResource\", calendarId);\n        return;\n      }\n\n      // story\n      const storyIdx = state.calendars[calendarIdx].stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on updateResource\", calendarId);\n        return;\n      }\n\n      // process\n      state.calendars[calendarIdx].stories[storyIdx].resources.push(resource);\n    },\n    updateResource(state, action: PayloadAction<UpdateResourcePayload>) {\n      const { calendarId, storyId, newResource } = action.payload;\n\n      // calendar\n      const calendarIdx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFind = calendarIdx === -1;\n      if (cannotFind) {\n        console.warn(\"cannot find calendar on updateResource\", calendarId);\n        return;\n      }\n\n      // story\n      const storyIdx = state.calendars[calendarIdx].stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on updateResource\", calendarId);\n        return;\n      }\n\n      // query\n      const resourceIdx = state.calendars[calendarIdx].stories[\n        storyIdx\n      ].resources.findIndex((resource) => resource.id === newResource.id);\n      const cannotFindResource = resourceIdx === -1;\n      if (cannotFindResource) {\n        console.warn(\"cannot find resource on updateResource\", calendarId);\n        return;\n      }\n      state.calendars[calendarIdx].stories[storyIdx].resources[\n        resourceIdx\n      ] = newResource;\n    },\n    removeResource(state, action: PayloadAction<RemoveResourcePayload>) {\n      const { calendarId, resourceId, storyId } = action.payload;\n\n      // calendar\n      const calendarIdx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFind = calendarIdx === -1;\n      if (cannotFind) {\n        console.warn(\"cannot find calendar on removeResource\", calendarId);\n        return;\n      }\n\n      // story\n      const storyIdx = state.calendars[calendarIdx].stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on removeResource\", calendarId);\n        return;\n      }\n\n      // query\n      state.calendars[calendarIdx].stories[\n        storyIdx\n      ].resources = state.calendars[calendarIdx].stories[\n        storyIdx\n      ].resources.filter((resource) => resource.id !== resourceId);\n    },\n    addStory(state, action: PayloadAction<AddStoryPayload>) {\n      const { calendarId, story } = action.payload;\n      const idx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFind = idx === -1;\n      if (cannotFind) {\n        console.warn(\"cannot find calendar on addStory\", calendarId);\n        return;\n      }\n      state.calendars[idx].stories.push(story);\n    },\n    removeStory(state, action: PayloadAction<RemoveStoryPayload>) {\n      const { calendarId, storyId } = action.payload;\n      const idx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFind = idx === -1;\n      if (cannotFind) {\n        console.warn(\"cannot find calendar on removeStory\", calendarId);\n        return;\n      }\n      state.calendars[idx].stories = state.calendars[idx].stories.filter(\n        (story) => story.id !== storyId\n      );\n    },\n    updateStory(state, action: PayloadAction<UpdateStoryPayload>) {\n      const { calendarId, storyId, newStory } = action.payload;\n      // calendar\n      const calendarIdx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFindCalendar = calendarIdx === -1;\n      if (cannotFindCalendar) {\n        console.warn(\"cannot find calendar on updateStory\", calendarId);\n        return;\n      }\n\n      // story\n      const storyIdx = state.calendars[calendarIdx].stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on updateStory\", calendarId);\n        return;\n      }\n\n      // prcess\n      state.calendars[calendarIdx].stories[storyIdx] = newStory;\n    },\n    addEvent(state, action: PayloadAction<AddEventPayload>) {\n      const { calendarId, storyId, event } = action.payload;\n\n      // calendar\n      const calendarIdx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFindCalendar = calendarIdx === -1;\n      if (cannotFindCalendar) {\n        console.warn(\"cannot find calendar on addEvent\", calendarId);\n        return;\n      }\n\n      // story\n      const storyIdx = state.calendars[calendarIdx].stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on addEvent\", calendarId);\n        return;\n      }\n\n      // addd\n      state.calendars[calendarIdx].stories[storyIdx].events.push(event);\n    },\n    removeEvent(state, action: PayloadAction<RemoveEventPayload>) {\n      const { calendarId, storyId, eventId } = action.payload;\n\n      // calendar\n      const calendarIdx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFindCalendar = calendarIdx === -1;\n      if (cannotFindCalendar) {\n        console.warn(\"cannot find calendar on removeEvent\", calendarId);\n        return;\n      }\n\n      // story\n      const storyIdx = state.calendars[calendarIdx].stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on removeEvent\", storyIdx);\n        return;\n      }\n\n      // remove\n      state.calendars[calendarIdx].stories[storyIdx].events = state.calendars[\n        calendarIdx\n      ].stories[storyIdx].events.filter((_event) => _event.id !== eventId);\n    },\n    updateEvent(state, action: PayloadAction<UpdateEventPayload>) {\n      const { calendarId, storyId, eventId, newEvent } = action.payload;\n\n      // calendar\n      const calendarIdx = state.calendars.findIndex(\n        (calendar) => calendar.id === calendarId\n      );\n      const cannotFindCalendar = calendarIdx === -1;\n      if (cannotFindCalendar) {\n        console.warn(\"cannot find calendar on updateStory\", calendarId);\n        return;\n      }\n\n      // story\n      const storyIdx = state.calendars[calendarIdx].stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on updateStory\", calendarId);\n        return;\n      }\n\n      // event\n      const eventIdx = state.calendars[calendarIdx].stories[\n        storyIdx\n      ].events.findIndex((event) => event.id === eventId);\n      const cannotFindEvent = eventIdx === -1;\n      if (cannotFindEvent) {\n        console.warn(\"cannot find event on updateEvent\");\n        return;\n      }\n\n      // prcess\n      state.calendars[calendarIdx].stories[storyIdx].events[\n        eventIdx\n      ] = newEvent;\n    },\n  },\n});\n\nexport const {\n  updateCalendars: updateCalendarsAction,\n\n  // resources\n  pushResource: pushResourceAction,\n  updateResource: updateResourceAction,\n  removeResource: removeResourceAction,\n\n  // story\n  addStory: addStoryAction,\n  removeStory: removeStoryAction,\n  updateStory: updateStoryAction,\n\n  // event\n  addEvent: addEventAction,\n  removeEvent: removeEventAction,\n  updateEvent: updateEventAction,\n} = userCalendarsSlice.actions;\n\nexport default userCalendarsSlice.reducer;\n\n// export const selectUserCalendars = (state: RootState) =>\n//   state.userCalendars.calendars;\n\nexport const selectUserCalendar = (state: RootState) =>\n  state.features.userCalendars.calendars[0]; // NOTE: now calendars have only 1 calendar.\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { DateSelectArg } from \"@fullcalendar/react\";\nimport { uuid } from \"../lib/uuid\";\nimport { createProfileStory } from \"../core/story/ProfileStory/createProfileStory\";\nimport { initEvent } from \"../core/event/BaseEvent\";\nimport { createUserCalendar } from \"../core/calendar/UserCalendar/createUserCalendar\";\nimport {\n  updateCalendarsAction,\n  addEventAction,\n  selectUserCalendar,\n} from \"../redux/features/userCalendars\";\nimport { MY_CALENDAR_ID } from \"../constants/fullcalendar/settings\";\n\nexport const useUserCalendar = () => {\n  const dispatch = useDispatch();\n  const calendar = useSelector(selectUserCalendar);\n\n  const init = React.useCallback(\n    (birthday: string | Date) => {\n      const calendarId = MY_CALENDAR_ID;\n      const story = createProfileStory({ birth: birthday, calendarId });\n      const _calendar = createUserCalendar({\n        id: calendarId,\n        stories: [story],\n      });\n      const _calendars = [_calendar];\n      dispatch(updateCalendarsAction({ calendars: _calendars }));\n    },\n    [dispatch]\n  );\n\n  const select = React.useCallback(\n    (info: DateSelectArg) => {\n      if (!info.resource) {\n        console.warn(\"Unexpected data that info does not have resource.\");\n        return;\n      }\n\n      // storyId\n      const storyId = info.resource.extendedProps.storyId;\n      if (!storyId) {\n        console.warn(\"Unexpected data not including storyId.\");\n        return;\n      }\n\n      // calendarId\n      const calendarId = info.resource.extendedProps.calendarId;\n      if (!calendarId) {\n        console.warn(\"Unexpected data not including calendarId.\");\n        return;\n      }\n\n      const newEvent = initEvent({\n        id: uuid(),\n        resourceId: info.resource.id,\n        calendarId,\n        storyId,\n        start: info.startStr,\n        end: info.endStr,\n      });\n\n      dispatch(addEventAction({ event: newEvent, calendarId, storyId }));\n    },\n    [dispatch]\n  );\n\n  const stories = React.useMemo(() => calendar?.stories ?? [], [calendar]);\n\n  const events = React.useMemo(\n    () => calendar?.stories.flatMap((story) => story.events) ?? [],\n    [calendar]\n  );\n\n  const resources = React.useMemo(\n    () => calendar?.stories.flatMap((story) => story.resources) ?? [],\n    [calendar]\n  );\n\n  return {\n    calendar,\n    stories,\n    events,\n    resources,\n    init,\n    select,\n  } as const;\n};\n","import { UserCalendar } from \"./model\";\nimport { ProfileStory } from \"../../story/ProfileStory/model\";\n\ntype Story = ProfileStory;\n\nexport const createUserCalendar = ({\n  id,\n  stories,\n}: {\n  id: string;\n  stories: Story[];\n}): UserCalendar => {\n  return {\n    id,\n    stories,\n  };\n};\n","import { ProfileStory } from \"./model\";\nimport { PROFILE_ID } from \"../../../constants/fullcalendar/settings\";\nimport { createStoryName } from \"../BaseStory\";\nimport { createProfileResources } from \"../../resource/createProfileResources\";\nimport { createProfileEvents } from \"../../event/createProfileEvents\";\n\nexport const createProfileStory = ({\n  birth,\n  calendarId,\n}: {\n  birth: string | Date;\n  calendarId: string;\n}): ProfileStory => {\n  const _birth = new Date(birth);\n  const storyId = PROFILE_ID;\n  return {\n    id: storyId,\n    calendarId,\n    name: createStoryName(_birth),\n    resources: createProfileResources({ calendarId, storyId }),\n    events: createProfileEvents({ calendarId, storyId, startDate: _birth }),\n  };\n};\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  removeStoryAction,\n  updateStoryAction,\n  addStoryAction,\n} from \"../redux/features/userCalendars\";\nimport { BaseStory, updateStory } from \"../core/story/BaseStory\";\nimport { initStory } from \"../core/story/BaseStory\";\ntype IdSet = { calendarId: string; storyId: string };\n\nexport const useStory = () => {\n  const dispatch = useDispatch();\n\n  const remove = React.useCallback(({ calendarId, storyId }: IdSet) => {\n    // TODO: move this line outside\n    if (!window.confirm(\"Do you remove this story?\")) return;\n    dispatch(\n      removeStoryAction({\n        storyId,\n        calendarId,\n      })\n    );\n  }, [dispatch]);\n\n  const update = React.useCallback(\n    (idSet: IdSet, story: BaseStory, data: any) => {\n      const newStory = updateStory(story, data);\n      dispatch(updateStoryAction({ ...idSet, newStory }));\n    },\n    [dispatch]\n  );\n\n  const create  = React.useCallback(({calendarId}: {calendarId: string}, params?: Partial<BaseStory>) => {\n    const story = initStory({ calendarId });\n    dispatch(addStoryAction({ calendarId, story }));\n  }, [dispatch]);\n\n  return { remove, update, create } as const;\n};\n","import { NAME_OF_STORY_ID, NAME_OF_ORDER } from \"./settings\";\n\nexport const MY_TIME_LINE_NAME = \"MY_TIME_LINE_NAME\";\n\nexport const AGE_OF_START_STORY = 21;\n\nconst slotLabelFormat = [{ year: \"numeric\" }, { month: \"numeric\" }];\n\nconst headerToolbar = {\n  left: \"today prev,next\",\n  center: \"title\",\n  right: `${MY_TIME_LINE_NAME},listMonth`,\n} as const;\n\nconst initialView = { initialView: MY_TIME_LINE_NAME } as const;\n\nconst resourceGroupField = { resourceGroupField: NAME_OF_STORY_ID } as const;\n\nconst schedulerLicenseKey = {\n  schedulerLicenseKey: \"GPL-My-Project-Is-Open-Source\",\n} as const;\n\nconst views = {\n  [MY_TIME_LINE_NAME]: {\n    type: \"resourceTimelineYear\",\n    duration: { year: 15 },\n    buttonText: \"TIME_LINE\",\n  },\n} as const;\n\nconst nowIndicator = {\n  nowIndicator: true,\n} as const;\n\nconst resourceConfigs = {\n  resourceOrder: NAME_OF_ORDER,\n  resourcesInitiallyExpanded: false,\n} as const;\n\nexport const FULL_CALENDAR_CONFIGS = {\n  views,\n  headerToolbar,\n  slotLabelFormat,\n  ...initialView,\n  ...resourceGroupField,\n  ...schedulerLicenseKey,\n  ...nowIndicator,\n  ...resourceConfigs,\n} as const;\n","import React, { PropsWithChildren } from \"react\";\nimport FullCalendarLib from \"@fullcalendar/react\";\nimport resourceTimelinePlugin from \"@fullcalendar/resource-timeline\";\nimport listPlugin from \"@fullcalendar/list\";\nimport interactionPlugin from \"@fullcalendar/interaction\";\nimport { FULL_CALENDAR_CONFIGS } from \"../../constants/fullcalendar/options\";\n\nexport function BaseFullCalendar<T>(props: PropsWithChildren<T>) {\n  return (\n    <FullCalendarLib\n      {...FULL_CALENDAR_CONFIGS}\n      plugins={[interactionPlugin, resourceTimelinePlugin, listPlugin]}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\nimport { BaseFullCalendar } from \"./BaseFullCalendar\";\n\nexport function BaseCalendarContainer(props: any) {\n  const args = {\n    // \n  };\n\n  return <BaseFullCalendar {...props} {...args} />;\n}\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectUserCalendar } from \"../redux/features/userCalendars\";\nimport { MY_CALENDAR_ID } from \"../constants/fullcalendar/settings\";\n\n\ntype Props = {\n  createOpenHandle: Function;\n}\n\ntype ContentProps = {\n  // REF: https://fullcalendar.io/docs/resource-group-render-hooks\n  groupValue: string;\n};\n\nexport const useResourceGroupLabelContentInUserCalendar = ({createOpenHandle}: Props) => {\n  const calendar = useSelector(\n    selectUserCalendar\n  );\n\n  const resourceGroupLabelContent = React.useCallback(\n    ({ groupValue: storyId }: ContentProps) => {\n      if (!calendar) return;\n\n      // story validation\n      const story = calendar.stories.find((story) => story.id === storyId);\n      if (!story) {\n        console.warn(\"cannot find story\", storyId);\n        return;\n      }\n\n      // name handler\n      let name: string;\n      if (story.name) {\n        name = story.name;\n      } else {\n        console.warn(\"cannot find this story name\", storyId);\n        name = \"No Name\";\n      }\n\n      const calendarId = MY_CALENDAR_ID;\n      const openHandle = createOpenHandle({calendarId, storyId})\n\n      const nameElement = document.createElement('i')\n      nameElement.innerHTML = name + ' ' // NOTE: space is for design, so not good way\n\n      const buttonElement = document.createElement('button')\n      buttonElement.innerHTML = ''\n      buttonElement.onclick = openHandle\n\n      const arrayOfDomNodes = [nameElement, buttonElement];\n      return { domNodes: arrayOfDomNodes };\n    },\n    [calendar, createOpenHandle]\n  );\n\n  return {resourceGroupLabelContent};\n};\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../rootReducer\";\n\ntype State = {\n  resource: null | {\n    calendarId: string;\n    storyId: string;\n    resourceId: string;\n  };\n};\n\ntype PushPayload = {\n  calendarId: string;\n  storyId: string;\n  resourceId: string;\n};\n\ntype PopPayload = undefined;\n\nconst slice = createSlice({\n  name: \"resourceModal\",\n  initialState: {\n    resource: null,\n  } as State,\n  reducers: {\n    push(state, action: PayloadAction<PushPayload>) {\n      const _payload = action.payload;\n      state.resource = _payload;\n    },\n    pop(state, _action: PayloadAction<PopPayload>) {\n      state.resource = null;\n    },\n  },\n});\n\nexport const selectIsOpen = (state: RootState) =>\n  !!state.ui.resourceModal.resource;\n\nexport const selectResourceModal = (state: RootState) =>\n  state.ui.resourceModal.resource;\n\nexport const selectResource = (state: RootState) => {\n  const _resource = state.ui.resourceModal.resource;\n  if (!_resource) return null;\n  const { calendarId, storyId, resourceId } = _resource;\n\n  // calendar\n  const calendarIdx = state.features.userCalendars.calendars.findIndex(\n    (calendar) => calendar.id === calendarId\n  );\n  const cannotFind = calendarIdx === -1;\n  if (cannotFind) {\n    console.warn(\"cannot find calendar on removeResource\", calendarId);\n    return;\n  }\n\n  // story\n  const storyIdx = state.features.userCalendars.calendars[\n    calendarIdx\n  ].stories.findIndex((story) => story.id === storyId);\n  const cannotFindStory = storyIdx === -1;\n  if (cannotFindStory) {\n    console.warn(\"cannot find story on removeResource\", calendarId);\n    return;\n  }\n\n  //\n  return state.features.userCalendars.calendars[calendarIdx].stories[\n    storyIdx\n  ].resources.find((resource) => resource.id === resourceId);\n};\n\nexport const { push: pushAction, pop: popAction } = slice.actions;\n\nexport default slice.reducer;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../rootReducer\";\n\ntype State = {\n  story: null | {\n    calendarId: string;\n    storyId: string;\n  };\n};\n\ntype PushPayload = {\n  calendarId: string;\n  storyId: string;\n};\n\ntype PopPayload = undefined;\n\nconst slice = createSlice({\n  name: \"storyModal\",\n  initialState: {\n    story: null,\n  } as State,\n  reducers: {\n    push(state, action: PayloadAction<PushPayload>) {\n      const _payload = action.payload;\n      state.story = _payload;\n    },\n    pop(state, _action: PayloadAction<PopPayload>) {\n      state.story = null;\n    },\n  },\n});\n\nexport const selectIsOpen = (state: RootState) => !!state.ui.storyModal.story;\n\nexport const selectStoryModal = (state: RootState) => state.ui.storyModal.story;\n\nexport const selectStory = (state: RootState) => {\n  const _story = state.ui.storyModal.story;\n  if (!_story) return null;\n  const { calendarId, storyId } = _story;\n\n  // calendar\n  const calendarIdx = state.features.userCalendars.calendars.findIndex(\n    (calendar) => calendar.id === calendarId\n  );\n  const cannotFind = calendarIdx === -1;\n  if (cannotFind) {\n    console.warn(\"cannot find calendar on removeStory\", calendarId);\n    return;\n  }\n\n  // story\n  return state.features.userCalendars.calendars[calendarIdx].stories.find(\n    (story) => story.id === storyId\n  );\n};\n\nexport const { push: pushAction, pop: popAction } = slice.actions;\n\nexport default slice.reducer;\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../rootReducer\";\n\ntype State = {\n  event: null | {\n    calendarId: string;\n    storyId: string;\n    eventId: string;\n  };\n};\n\ntype PushPayload = {\n  calendarId: string;\n  storyId: string;\n  eventId: string;\n};\n\ntype PopPayload = undefined;\n\nconst slice = createSlice({\n  name: \"eventModal\",\n  initialState: {\n    event: null,\n  } as State,\n  reducers: {\n    push(state, action: PayloadAction<PushPayload>) {\n      const _payload = action.payload;\n      state.event = _payload;\n    },\n    pop(state, _action: PayloadAction<PopPayload>) {\n      state.event = null;\n    },\n  },\n});\n\nexport const selectIsOpen = (state: RootState) => !!state.ui.eventModal.event;\n\nexport const selectEventModal = (state: RootState) => state.ui.eventModal.event;\n\nexport const selectEvent = (state: RootState) => {\n  const event = state.ui.eventModal.event;\n  if (!event) return null;\n  const { calendarId, storyId, eventId } = event;\n\n  // calendar\n  const calendarIdx = state.features.userCalendars.calendars.findIndex(\n    (calendar) => calendar.id === calendarId\n  );\n  const cannotFind = calendarIdx === -1;\n  if (cannotFind) {\n    console.warn(\"cannot find calendar on removeResource\", calendarId);\n    return;\n  }\n\n  // story\n  const storyIdx = state.features.userCalendars.calendars[\n    calendarIdx\n  ].stories.findIndex((story) => story.id === storyId);\n  const cannotFindStory = storyIdx === -1;\n  if (cannotFindStory) {\n    console.warn(\"cannot find story on removeResource\", calendarId);\n    return;\n  }\n\n  //\n  return state.features.userCalendars.calendars[calendarIdx].stories[\n    storyIdx\n  ].events.find((event) => event.id === eventId);\n};\n\nexport const { push: pushAction, pop: popAction } = slice.actions;\n\nexport default slice.reducer;\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectResource } from \"../redux/ui/resourceModal\";\nimport { selectUserCalendar } from \"../redux/features/userCalendars\";\nimport {\n  removeResourceAction,\n  updateResourceAction,\n  pushResourceAction,\n} from \"../redux/features/userCalendars\";\nimport {\n  BaseResource,\n  initResource,\n  updateResource,\n} from \"../core/resource/BaseResource\";\n\ntype IdSet = { calendarId: string; resourceId: string; storyId: string };\n\nexport const useResource = () => {\n  const dispatch = useDispatch();\n\n  // TODO: remoove this line and get params as arg in each function\n  const resource = useSelector(selectResource);\n  const calendar = useSelector(selectUserCalendar);\n\n  const push = React.useCallback(\n    ({ calendarId, storyId }: { calendarId: string; storyId: string }) => {\n      // story\n      const storyIdx = calendar.stories.findIndex(\n        (story) => story.id === storyId\n      );\n      const cannotFindStory = storyIdx === -1;\n      if (cannotFindStory) {\n        console.warn(\"cannot find story on updateResource\", calendarId);\n        return;\n      }\n\n      // resource\n      const _resources = calendar.stories[storyIdx].resources;\n      let lastResource = { idx: -1, order: -1 };\n      for (let i = 0; i < _resources.length; i++) {\n        const resource = _resources[i];\n        const _order = resource.order ?? -1;\n        if (_order > lastResource.order) {\n          lastResource = { idx: i, order: _order };\n        }\n      }\n\n      const _resource = initResource({\n        calendarId,\n        storyId,\n        order: lastResource.order + 1,\n      });\n\n      dispatch(pushResourceAction({ calendarId, storyId, resource:_resource }));\n    },\n    [dispatch, calendar]\n  );\n\n  const remove = React.useCallback(\n    ({ calendarId, resourceId, storyId }: IdSet) => {\n\n      // TODO: Move outside\n      if (!window.confirm(\"Do you remove this resource?\")) return;\n\n      dispatch(\n        removeResourceAction({\n          resourceId: resourceId,\n          storyId: storyId,\n          calendarId,\n        })\n      );\n    },\n    [dispatch]\n  );\n\n  const update = React.useCallback(\n    ({ calendarId, storyId }: IdSet, params: Partial<BaseResource>) => {\n      if (!resource) {\n        return console.warn(\"Invalid data status when to update resource.\");\n      }\n\n      const newResource = updateResource(resource, params);\n      dispatch(\n        updateResourceAction({\n          calendarId,\n          storyId: storyId,\n          newResource,\n        })\n      );\n    },\n    [dispatch, resource]\n  );\n\n  return { remove, update, push } as const;\n};\n","import React from \"react\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport { useForm } from \"react-hook-form\";\nimport { useSelector } from \"react-redux\";\nimport {\n  selectResourceModal,\n  selectResource,\n} from \"../../redux/ui/resourceModal\";\nimport { FIELD1, FIELD2 } from \"../../constants/fullcalendar/settings\";\nimport { useResource } from \"../../hooks/useResource\";\n\ntype Props = {\n  isOpen: boolean;\n  onClose: () => void;\n};\n\nexport function ResourceModal({ isOpen, onClose }: Props) {\n  const resourceModal = useSelector(selectResourceModal);\n  const resource = useSelector(selectResource);\n  const field1 = (resource && resource[FIELD1]) ?? \"\";\n  const field2 = (resource && resource[FIELD2]) ?? \"\";\n\n  const { remove, update } = useResource();\n\n  const onRemove = React.useCallback(() => {\n    if (!resourceModal) {\n      return console.warn(\"Invalid data status when to update resource.\");\n    }\n    remove(resourceModal);\n    onClose();\n  }, [resourceModal, remove, onClose]);\n\n  const onUpdate = React.useCallback(\n    (data: { [FIELD1]: string; [FIELD2]: string }) => {\n      if (!resourceModal) {\n        return console.warn(\"Invalid data status when to remove resource.\");\n      }\n      update(resourceModal, data);\n      onClose();\n    },\n    [resourceModal, update, onClose]\n  );\n\n  // TODO: error handler\n  // const { register, handleSubmit, errors } = useForm();\n  const { register, handleSubmit } = useForm();\n\n  return (\n    <Dialog onClose={onClose} open={isOpen}>\n      <DialogTitle>Resource</DialogTitle>\n      <DialogContent dividers={true}>\n        <form onSubmit={handleSubmit(onUpdate)}>\n          <input ref={register} name={FIELD1} defaultValue={field1} />\n          <input ref={register} name={FIELD2} defaultValue={field2} />\n          <input type=\"submit\" value=\"Update\" />\n        </form>\n        <hr />\n        <button onClick={onRemove}>Remove</button>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import React from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\n// import { useForm } from \"react-hook-form\";\nimport { useSelector } from \"react-redux\";\nimport { selectStoryModal, selectStory } from \"../../redux/ui/storyModal\";\n// import { FIELD1, FIELD2 } from \"../../constants/fullcalendar/settings\";\nimport { useStory } from \"../../hooks/useStory\";\nimport { useResource } from \"../../hooks/useResource\";\n\ntype Props = {\n  isOpen: boolean;\n  onClose: () => void;\n};\n\nexport function StoryModal({ isOpen, onClose }: Props) {\n  const storyModal = useSelector(selectStoryModal);\n  const story = useSelector(selectStory);\n  // const field1 = (resource && resource[FIELD1]) ?? \"\";\n  // const field2 = (resource && resource[FIELD2]) ?? \"\";\n\n  const { remove: removeStory, update: updateStory } = useStory();\n  const { push: pushResource } = useResource();\n\n  const handleRemove = React.useCallback(() => {\n    if (!storyModal) {\n      return console.warn(\"Invalid data status when to update resource.\");\n    }\n    removeStory(storyModal);\n    onClose();\n  }, [storyModal, removeStory, onClose]);\n\n  const handleAddResource = React.useCallback(() => {\n    if (!storyModal) {\n      return console.warn(\"Invalid data status when to add resource.\");\n    }\n    pushResource(storyModal);\n    onClose();\n  }, [storyModal, pushResource, onClose]);\n\n  const { register, handleSubmit } = useForm();\n\n  const onSubmit = React.useCallback(\n    (data: any) => {\n      if (!storyModal || !story) {\n        return console.warn(\"Invalid data status when to update story.\");\n      }\n      updateStory(storyModal, story, data);\n      onClose();\n    },\n    [updateStory, storyModal, story, onClose]\n  );\n\n  // // TODO: error handler\n  // // const { register, handleSubmit, errors } = useForm();\n  // const { register, handleSubmit } = useForm();\n\n  return (\n    <Dialog onClose={onClose} open={isOpen}>\n      <DialogTitle>Resource</DialogTitle>\n      <DialogContent dividers={true}>\n        <form onSubmit={handleSubmit(onSubmit)}>\n          <input ref={register} name=\"name\" defaultValue={story?.name} />\n          <input type=\"submit\" value=\"rename\" />\n        </form>\n        <button onClick={handleRemove}>remove</button>\n        <button onClick={handleAddResource}>add resource</button>\n        {/* <form onSubmit={handleSubmit(onUpdate)}>\n          <input ref={register} name={FIELD1} defaultValue={field1} />\n          <input ref={register} name={FIELD2} defaultValue={field2} />\n          <input type=\"submit\" value=\"Update\" />\n        </form>\n        <hr />\n        <button onClick={handleRemove}>Remove</button> */}\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  removeEventAction,\n  updateEventAction,\n} from \"../redux/features/userCalendars\";\nimport { BaseEvent, updateEvent } from \"../core/event/BaseEvent\";\n\ntype IdSet = { calendarId: string; storyId: string; eventId: string };\n\nexport const useEvent = () => {\n  const dispatch = useDispatch();\n\n  const remove = React.useCallback(\n    ({ calendarId, storyId, eventId }: IdSet) => {\n      if (!window.confirm(\"Do you remove this story?\")) return;\n      dispatch(\n        removeEventAction({\n          calendarId,\n          storyId,\n          eventId,\n        })\n      );\n    },\n    [dispatch]\n  );\n\n  const update = React.useCallback(\n    (idSet: IdSet, event: BaseEvent, data: any) => {\n      const newEvent = updateEvent(event, data);\n      dispatch(updateEventAction({ ...idSet, newEvent }));\n    },\n    [dispatch]\n  );\n\n  return {\n    remove,\n    update\n  } as const;\n};\n","import React from \"react\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport { useForm } from \"react-hook-form\";\nimport { useSelector } from \"react-redux\";\nimport {\n  selectEventModal,\n  selectEvent,\n} from \"../../redux/ui/eventModal\";\nimport { useEvent } from \"../../hooks/useEvent\";\nimport {BaseEvent} from '../../core/event/BaseEvent'\n\ntype Props = {\n  isOpen: boolean;\n  onClose: () => void;\n};\n\nexport function EventModal({ isOpen, onClose }: Props) {\n  const eventModal = useSelector(selectEventModal);\n  const event = useSelector(selectEvent);\n\n  const { remove, update } = useEvent();\n\n  const onRemove = React.useCallback(() => {\n    if (!eventModal) {\n      return console.warn(\"Invalid data status when to update event.\");\n    }\n    remove(eventModal);\n    onClose();\n  }, [eventModal, remove, onClose]);\n\n  const onUpdate = React.useCallback(\n    (data: Partial<BaseEvent>) => {\n      if (!eventModal || !event) {\n        return console.warn(\"Invalid data status when to remove event.\");\n      }\n      update(eventModal, event, data);\n      onClose();\n    },\n    [eventModal, event, update, onClose]\n  );\n\n  // TODO: error handler\n  const { register, handleSubmit } = useForm();\n\n  return (\n    <Dialog onClose={onClose} open={isOpen}>\n      <DialogTitle>Resource</DialogTitle>\n      <DialogContent dividers={true}>\n        <form onSubmit={handleSubmit(onUpdate)}>\n          <input ref={register} name={'title'} defaultValue={event?.title} />\n          <input type=\"submit\" value=\"rename\" />\n        </form>\n        <hr />\n        <button onClick={onRemove}>Remove</button>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useUserCalendar } from \"../../hooks/useUserCalendar\";\nimport { useUser } from \"../../hooks/useUser\";\nimport { useStory } from \"../../hooks/useStory\";\nimport { BaseCalendarContainer } from \"../../components/atoms/BaseCalendarContainer\";\nimport { useResourceGroupLabelContentInUserCalendar } from \"../../hooks/useResourceGroupLabelContentInUserCalendar\";\nimport { useResourceModal } from \"../../hooks/useResourceModal\";\nimport { useStoryModal } from \"../../hooks/useStoryModal\";\nimport { useEventModal } from \"../../hooks/useEventModal\";\nimport { pushAction as pushStoryModalAction } from \"../../redux/ui/storyModal\";\nimport { FIELD1, FIELD2 } from \"../../constants/fullcalendar/settings\";\nimport { ResourceModal } from \"../../components/molecules/ResourceModal\";\nimport { StoryModal } from \"../../components/molecules/StoryModal\";\nimport { EventModal } from \"../../components/molecules/EventModal\";\nimport { EventClickArg } from \"@fullcalendar/react\";\nimport { pushAction as pushEventModalAction } from \"../../redux/ui/eventModal\";\nimport { MY_CALENDAR_ID } from \"../../constants/fullcalendar/settings\";\n\nconst ableConfis = {\n  selectable: true,\n  editable: true,\n} as const;\n\nexport function UserCalendarContainer() {\n  const {\n    push: pushResourceModal,\n    pop: popResourceModal,\n    isOpen: isOpenResourceModal,\n  } = useResourceModal();\n\n  const {\n    push: pushStoryModal,\n    pop: popStoryModal,\n    isOpen: isOpenStoryModal,\n  } = useStoryModal();\n\n  const { pop: popEventModal, isOpen: isOpenEventModal } = useEventModal();\n\n  const { birth } = useUser();\n  const dispatch = useDispatch();\n\n  const createOpenStoryHandle = React.useCallback(\n    ({\n      calendarId,\n      storyId,\n    }: {\n      calendarId: string;\n      storyId: string;\n    }) => () => {\n      dispatch(pushStoryModalAction({ calendarId, storyId }));\n      pushStoryModal({ calendarId, storyId });\n    },\n    [pushStoryModal, dispatch]\n  );\n\n  const {\n    resourceGroupLabelContent,\n  } = useResourceGroupLabelContentInUserCalendar({\n    createOpenHandle: createOpenStoryHandle,\n  });\n\n  const {\n    events,\n    resources,\n    init: initUserCalendar,\n    select,\n  } = useUserCalendar();\n\n  const { create: createStory } = useStory();\n\n  const calendarId = MY_CALENDAR_ID;\n  const handleCreateStory = React.useCallback(() => {\n    const doCreateStroy = () => createStory({ calendarId });\n    return doCreateStroy;\n  }, [createStory, calendarId]);\n\n  const click = React.useCallback(\n    (info: EventClickArg) => {\n      const calendarId = info.event.extendedProps.calendarId as\n        | string\n        | undefined;\n      if (!calendarId) {\n        return console.warn(\"Invalid data. cannot find calendarId.\");\n      }\n\n      const eventId = info.event.id;\n      if (!eventId) {\n        return console.warn(\"Invalid data. cannot find eventId.\");\n      }\n\n      const storyId = info.event.extendedProps.storyId as string | undefined;\n      if (!storyId) {\n        return console.warn(\"Invalid data. cannot find storyId.\");\n      }\n\n      const idSet = {\n        calendarId,\n        eventId,\n        storyId,\n      };\n\n      dispatch(pushEventModalAction(idSet));\n    },\n    [dispatch]\n  );\n\n  React.useEffect(() => {\n    initUserCalendar(birth);\n  }, [birth, initUserCalendar]);\n\n  const resourceAreaColumns = React.useMemo(\n    () => [\n      {\n        field: FIELD1,\n        headerContent: \"Category\",\n      },\n      {\n        field: FIELD2,\n        headerContent: \"Event\",\n        cellContent: function (arg: any) {\n          const props = arg.resource.extendedProps;\n          const storyId = props[\"storyId\"];\n          if (!storyId) {\n            return console.warn(\n              \"Invalid data that extended props doesn't storyId.\"\n            );\n          }\n          const resourceId = arg.resource.id;\n          if (!resourceId) {\n            return console.warn(\n              \"Invalid data that extended props doesn't resourceId.\"\n            );\n          }\n          const calendarId = props[\"calendarId\"];\n          if (!calendarId) {\n            return console.warn(\n              \"Invalid data that extended props doesn't calendarId.\"\n            );\n          }\n\n          let message = arg.fieldValue;\n          message += \"!!!\";\n\n          const containerEl = document.createElement(\"div\");\n\n          const buttonEl = document.createElement(\"button\");\n          buttonEl.innerHTML = \"\";\n          buttonEl.onclick = () =>\n            pushResourceModal({ calendarId, storyId, resourceId });\n          containerEl.appendChild(buttonEl);\n\n          const messageEl = document.createElement(\"span\");\n          messageEl.innerHTML = message;\n          containerEl.appendChild(messageEl);\n\n          const arrayOfDomNodes = [containerEl];\n          return { domNodes: arrayOfDomNodes };\n        },\n      },\n    ],\n    [pushResourceModal]\n  );\n\n  return (\n    <>\n      <div>\n        <BaseCalendarContainer\n          events={events}\n          resources={resources}\n          select={select}\n          eventClick={click}\n          initialDate={\"2020-06-01\"}\n          resourceGroupLabelContent={resourceGroupLabelContent}\n          resourceAreaColumns={resourceAreaColumns}\n          {...ableConfis}\n        />\n        <button onClick={handleCreateStory}>story:add</button>\n      </div>\n\n      {/* Modal */}\n      <ResourceModal isOpen={isOpenResourceModal} onClose={popResourceModal} />\n      <StoryModal isOpen={isOpenStoryModal} onClose={popStoryModal} />\n      <EventModal isOpen={isOpenEventModal} onClose={popEventModal} />\n    </>\n  );\n}\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { pushAction, popAction, selectIsOpen } from \"../redux/ui/resourceModal\";\n\ntype IdSet = {\n  resourceId: string;\n  storyId: string;\n  calendarId: string;\n};\n\nexport const useResourceModal = () => {\n  const dispatch = useDispatch();\n\n  const push = React.useCallback(\n    ({ resourceId, storyId, calendarId }: IdSet) => {\n      dispatch(pushAction({ calendarId, resourceId, storyId }));\n    },\n    [dispatch]\n  );\n\n  const pop = React.useCallback(() => {\n    dispatch(popAction());\n  }, [dispatch]);\n\n  const isOpen = useSelector(selectIsOpen);\n\n  return { push, pop, isOpen } as const;\n};\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { pushAction, popAction, selectIsOpen } from \"../redux/ui/storyModal\";\n\nexport const useStoryModal = () => {\n  const dispatch = useDispatch();\n\n  const push = React.useCallback(\n    ({\n      storyId,\n      calendarId,\n    }: {\n      storyId: string;\n      calendarId: string;\n    }) => {\n      dispatch(pushAction({ calendarId, storyId }));\n    },\n    [dispatch]\n  );\n\n  const pop = React.useCallback(() => {\n    dispatch(popAction());\n  }, [dispatch]);\n\n  const isOpen = useSelector(selectIsOpen);\n\n  return { push, pop, isOpen } as const;\n};\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { pushAction, popAction, selectIsOpen } from \"../redux/ui/eventModal\";\n\nexport const useEventModal = () => {\n  const dispatch = useDispatch();\n\n  const push = React.useCallback(\n    ({\n      eventId,\n      storyId,\n      calendarId,\n    }: {\n      eventId: string;\n      storyId: string;\n      calendarId: string;\n    }) => {\n      dispatch(pushAction({ calendarId, eventId, storyId }));\n    },\n    [dispatch]\n  );\n\n  const pop = React.useCallback(() => {\n    dispatch(popAction());\n  }, [dispatch]);\n\n  const isOpen = useSelector(selectIsOpen);\n\n  return { push, pop, isOpen } as const;\n};\n","import { BaseCalendar } from \"../BaseCalendar\";\nimport { COMMUNITY_COLLEGE_CALENDAR_ID } from \"../../../constants/fullcalendar/settings\";\n\nexport type CommunityCollegeCalendar = BaseCalendar;\n\nexport const calendarId = COMMUNITY_COLLEGE_CALENDAR_ID;\n","import { addMonths, addYears, setMonth } from \"date-fns\";\nimport {\n  RESOURCE_TEMPLATE__VISA_STUDY,\n  RESOURCE_TEMPLATE__VISA_COOP,\n  RESOURCE_TEMPLATE__WORKING_HOLIDAY_COOP,\n  RESOURCE_TEMPLATE__STUDENT_STATUS,\n  RESOURCE_TEMPLATE__WORKER_STATUS,\n} from \"../../../constants/fullcalendar/templates\";\nimport {\n  NAME_OF_STORY_ID,\n  NAME_OF_ORDER,\n} from \"../../../constants/fullcalendar/settings\";\nimport { uuid } from \"../../../lib/uuid\";\nimport { CommunityCollegeStory } from \"./model\";\nimport { createStoryName } from \"../BaseStory\";\nimport { BaseEvent } from \"../../event/BaseEvent\";\nimport { BaseResource } from \"../../resource/BaseResource\";\n\nconst VISA_BACKGROUND_COLOR = \"#8fbc8b\";\nconst STATUS_BACKGROUND_COLOR = \"#ffd700\";\nconst WH_WARN_BACKGROUND_COLOR = \"#e73758\";\n\nexport const build = ({\n  startDate,\n  calendarId,\n  canWorkingholiday,\n}: {\n  startDate: Date;\n  calendarId: string;\n  canWorkingholiday: boolean;\n}): CommunityCollegeStory => {\n  const storyId = uuid();\n  const name = createStoryName(startDate);\n  const [resources, events] = generateStory({\n    calendarId,\n    storyId,\n    startDate,\n    canWorkingholiday,\n  });\n  return {\n    id: storyId,\n    calendarId,\n    name,\n    events,\n    resources,\n  };\n};\n\nconst generateStory = ({\n  calendarId,\n  storyId,\n  startDate,\n  canWorkingholiday,\n}: {\n  calendarId: string;\n  storyId: string;\n  startDate: Date;\n  canWorkingholiday: boolean;\n}) => {\n  let resources = [] as BaseResource[];\n  let events = [] as BaseEvent[];\n  const withCoop = true; // TODO:\n\n  if (withCoop) {\n    // Coop Visa\n    const coopVisaResourceId = uuid();\n    resources.push({\n      ...RESOURCE_TEMPLATE__VISA_COOP,\n      id: coopVisaResourceId,\n      calendarId,\n      [NAME_OF_STORY_ID]: storyId,\n      [NAME_OF_ORDER]: 1,\n    });\n    events.push({\n      id: uuid(),\n      resourceId: coopVisaResourceId,\n      storyId,\n      start: startDate.toISOString(),\n      end: addMonths(startDate, 12 * 2).toISOString(),\n      [NAME_OF_ORDER]: 1,\n      backgroundColor: VISA_BACKGROUND_COLOR,\n      extendedProps: {\n        resourceId: coopVisaResourceId,\n        calendarId,\n        storyId,\n      },\n    });\n  }\n\n  // StudyVisa\n  const studyVisaResourceId = uuid();\n  resources.push({\n    ...RESOURCE_TEMPLATE__VISA_STUDY,\n    id: studyVisaResourceId,\n    calendarId,\n    [NAME_OF_STORY_ID]: storyId,\n    [NAME_OF_ORDER]: 2,\n  });\n  events.push({\n    id: uuid(),\n    resourceId: studyVisaResourceId,\n    storyId,\n    start: startDate.toISOString(),\n    end: addMonths(startDate, 12 * 2).toISOString(),\n    [NAME_OF_ORDER]: 2,\n    backgroundColor: VISA_BACKGROUND_COLOR,\n    extendedProps: {\n      resourceId: studyVisaResourceId,\n      calendarId,\n      storyId,\n    },\n  });\n\n  if (canWorkingholiday) {\n    const workingholidayResourceId = uuid();\n    resources.push({\n      ...RESOURCE_TEMPLATE__WORKING_HOLIDAY_COOP,\n      id: workingholidayResourceId,\n      calendarId,\n      [NAME_OF_STORY_ID]: storyId,\n      [NAME_OF_ORDER]: 3,\n    });\n    const dateAsStartWorkingHoliday = addMonths(startDate, 12 * 2);\n    events.push({\n      // workingHolidayVisaEvent\n      id: uuid(),\n      resourceId: workingholidayResourceId,\n      storyId,\n      start: dateAsStartWorkingHoliday.toISOString(),\n      end: addMonths(dateAsStartWorkingHoliday, 12 * 1).toISOString(),\n      [NAME_OF_ORDER]: 3,\n      backgroundColor: VISA_BACKGROUND_COLOR,\n      extendedProps: {\n        resourceId: workingholidayResourceId,\n        calendarId,\n        storyId,\n      },\n    });\n    events.push({\n      // preWorkingHolidayVisaEvent\n      id: uuid(),\n      resourceId: workingholidayResourceId,\n      storyId,\n      start: setMonth(addYears(dateAsStartWorkingHoliday, -1), 8).toISOString(),\n      end: dateAsStartWorkingHoliday.toISOString(),\n      [NAME_OF_ORDER]: 3,\n      backgroundColor: WH_WARN_BACKGROUND_COLOR,\n      extendedProps: {\n        resourceId: workingholidayResourceId,\n        calendarId,\n        storyId,\n      },\n    });\n\n    // worker status\n    const workerStatusResourceId = uuid();\n    resources.push({\n      ...RESOURCE_TEMPLATE__WORKER_STATUS,\n      id: workerStatusResourceId,\n      calendarId,\n      [NAME_OF_STORY_ID]: storyId,\n      [NAME_OF_ORDER]: 5,\n    });\n    events.push({\n      id: uuid(),\n      resourceId: workerStatusResourceId,\n      storyId,\n      start: addMonths(startDate, 12 * 1).toISOString(),\n      end: addMonths(startDate, 12 * 3).toISOString(),\n      [NAME_OF_ORDER]: 5,\n      eventBackgroundCoor: STATUS_BACKGROUND_COLOR,\n      extendedProps: {\n        resourceId: workerStatusResourceId,\n        calendarId,\n        storyId,\n      },\n    });\n  }\n\n  // student status\n  const studentStatusResourceId = uuid();\n  resources.push({\n    ...RESOURCE_TEMPLATE__STUDENT_STATUS,\n    id: studentStatusResourceId,\n    calendarId,\n    [NAME_OF_STORY_ID]: storyId,\n    [NAME_OF_ORDER]: 4,\n  });\n  events.push({\n    id: uuid(),\n    resourceId: studentStatusResourceId,\n    storyId,\n    start: startDate.toISOString(),\n    end: addMonths(startDate, 12 * 2).toISOString(),\n    [NAME_OF_ORDER]: 4,\n    eventBackgroundCoor: STATUS_BACKGROUND_COLOR,\n    extendedProps: {\n      resourceId: studentStatusResourceId,\n      calendarId,\n      storyId,\n    },\n  });\n\n  return [[...resources], [...events]] as [BaseResource[], BaseEvent[]];\n};\n","import { addYears, addMonths } from \"date-fns\";\nimport { CommunityCollegeCalendar, calendarId } from \"./model\";\nimport { AGE_OF_START_STORY } from \"../../../constants/fullcalendar/options\";\nimport { WORKING_HOLIDAY_APPLICATION_LIMITATION_AGE } from \"../../../constants/visa\";\nimport { COMMUNITY_COLLEGE_EXAMPLE1 } from \"../../../constants/school\";\nimport { range } from \"../../../lib/util\";\nimport { build } from \"../../story/CommunityCollegeStory/build\";\nimport { BaseStory } from \"../../story/BaseStory\";\n\nconst startMonths = COMMUNITY_COLLEGE_EXAMPLE1.startMonths;\n\nconst addingNumbers = range(\n  AGE_OF_START_STORY,\n  WORKING_HOLIDAY_APPLICATION_LIMITATION_AGE\n);\n\nconst generateStoryList = ({\n  birth,\n  calendarId,\n  canWorkingholiday,\n}: {\n  birth: Date;\n  calendarId: string;\n  canWorkingholiday: boolean;\n}): BaseStory[] => {\n  return addingNumbers\n    .map((num) => addYears(birth, num))\n    .flatMap((startDate) => {\n      const datesInYear = startMonths.map((month) =>\n        addMonths(startDate, month)\n      );\n      return datesInYear;\n    })\n    .map((startDate) => {\n      return build({ startDate, calendarId, canWorkingholiday });\n    });\n};\n\nexport const createCalendar = ({\n  birth,\n  canWorkingholiday,\n}: {\n  birth: Date;\n  canWorkingholiday: boolean;\n}): CommunityCollegeCalendar => {\n  const stories = generateStoryList({ birth, calendarId, canWorkingholiday });\n  return {\n    id: calendarId,\n    stories,\n  };\n};\n","export const COMMUNITY_COLLEGE_EXAMPLE1 = {\n  name: \"example college\",\n  startMonths: [1, 5, 9],\n} as const;\n","// REF: https://stackoverflow.com/a/15453499/8842333\nexport function range(start: number, stop: number, step?: number) {\n  var a = [start],\n    b = start;\n  while (b < stop) {\n    a.push((b += step || 1));\n  }\n  return a;\n}\n","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { createCalendar } from \"../../core/calendar/CommunityCollegeCalendar/createCalendar\";\nimport { calendarId as CommunityCollegeCalendarId } from \"../../core/calendar/CommunityCollegeCalendar/model\";\nimport { BaseCalendar } from \"../../core/calendar/BaseCalendar\";\nimport { RootState } from \"../rootReducer\";\n\ntype upsertCommunityCollegeStoriesPayload = {\n  birth: string;\n  canWorkingholiday: boolean;\n};\n\nconst templateCalendarTable = createSlice({\n  name: \"templateCalendarTable\",\n  initialState: {\n    [CommunityCollegeCalendarId]: undefined as BaseCalendar | undefined,\n  },\n  reducers: {\n    upsertCommunityCollegeStories(\n      state,\n      action: PayloadAction<upsertCommunityCollegeStoriesPayload>\n    ) {\n      const { birth, canWorkingholiday } = action.payload;\n      const _calendar = createCalendar({\n        birth: new Date(birth),\n        canWorkingholiday,\n      });\n      state[CommunityCollegeCalendarId] = _calendar;\n    },\n  },\n});\n\nexport default templateCalendarTable.reducer;\n\nexport const {\n  upsertCommunityCollegeStories: upsertCommunityCollegeStoriesAction,\n} = templateCalendarTable.actions;\n\nexport const selectCommunityCollegeCalendar = (state: RootState) =>\n  state.features.templateCalendar[CommunityCollegeCalendarId];\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { BaseCalendarContainer } from \"../../components/atoms/BaseCalendarContainer\";\nimport { useCommunityCollegeCalendar } from \"../../hooks/useCommunityCollegeCalendar\";\nimport { useUser } from \"../../hooks/useUser\";\nimport { useResourceGroupLabelContentInTemplateCalendar } from \"../../hooks/useResourceGroupLabelContentInTemplateCalendar\";\nimport { FIELD1, FIELD2 } from \"../../constants/fullcalendar/settings\";\nimport { addStoryAction } from \"../../redux/features/userCalendars\";\nimport { BaseStory } from \"../../core/story/BaseStory\";\n\nconst ableConfis = {\n  selectable: false,\n  editable: false,\n} as const;\n\nconst resourceAreaColumns = [\n  {\n    field: FIELD1,\n    headerContent: \"Category\",\n  },\n  {\n    field: FIELD2,\n    headerContent: \"Event\",\n  },\n];\n\nexport function TemplateCalendarContainer() {\n  const dispatch = useDispatch();\n  const { birth, canWorkingholiday } = useUser();\n  const { resources, events, generate } = useCommunityCollegeCalendar();\n\n  const createClickHandel = React.useCallback(\n    ({ story, calendarId }: { story: BaseStory; calendarId: string }) => () => {\n      if (!window.confirm(\"Copy to my calendar?\")) return;\n      dispatch(addStoryAction({ calendarId, story }));\n    },\n    [dispatch]\n  );\n\n  const {\n    resourceGroupLabelContent,\n  } = useResourceGroupLabelContentInTemplateCalendar({ createClickHandel });\n\n  React.useEffect(() => {\n    generate({ birth, canWorkingholiday });\n  }, [generate, birth, canWorkingholiday]);\n\n  return (\n    <BaseCalendarContainer\n      events={events}\n      resources={resources}\n      initialDate={\"2020-06-01\"}\n      resourceGroupLabelContent={resourceGroupLabelContent}\n      resourceAreaColumns={resourceAreaColumns}\n      {...ableConfis}\n    />\n  );\n}\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { BaseEvent } from \"../core/event/BaseEvent\";\nimport { BaseResource } from \"../core/resource/BaseResource\";\nimport {\n  upsertCommunityCollegeStoriesAction,\n  selectCommunityCollegeCalendar,\n} from \"../redux/features/templateCalendarTable\";\n\nexport const useCommunityCollegeCalendar = () => {\n  const dispatch = useDispatch();\n  const generate = React.useCallback(\n    ({\n      birth,\n      canWorkingholiday,\n    }: {\n      birth: string;\n      canWorkingholiday: boolean;\n    }) => {\n      dispatch(\n        upsertCommunityCollegeStoriesAction({ birth, canWorkingholiday })\n      );\n    },\n    [dispatch]\n  );\n\n  const calendar = useSelector(selectCommunityCollegeCalendar);\n\n  const stories = React.useMemo(() => calendar?.stories ?? [], [calendar]);\n\n  const resources = React.useMemo(\n    () =>\n      stories.reduce<BaseResource[]>(\n        (prev, story) => [...prev, ...story.resources],\n        []\n      ),\n    [stories]\n  );\n\n  const events = React.useMemo(\n    () =>\n      stories.reduce<BaseEvent[]>(\n        (prev, story) => [...prev, ...story.events],\n        [] as any[]\n      ),\n    [stories]\n  );\n\n  return { stories, generate, resources, events } as const;\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectCommunityCollegeCalendar } from \"../redux/features/templateCalendarTable\";\nimport { MY_CALENDAR_ID } from \"../constants/fullcalendar/settings\";\n\ntype ResourceContentProps = {\n  // REF: https://fullcalendar.io/docs/resource-group-render-hooks\n  groupValue: string;\n};\n\ntype Props = {\n  createClickHandel: Function;\n};\n\nexport const useResourceGroupLabelContentInTemplateCalendar = ({\n  createClickHandel,\n}: Props) => {\n  const calendar = useSelector(selectCommunityCollegeCalendar);\n\n  const resourceGroupLabelContent = React.useCallback(\n    ({ groupValue: storyId }: ResourceContentProps) => {\n      if (!calendar) return;\n\n      // story validation\n      const story = calendar.stories.find((story) => story.id === storyId);\n      if (!story) {\n        console.warn(\"cannot find story\", storyId);\n        return;\n      }\n\n      // name handler\n      let name: string;\n      if (story.name) {\n        name = story.name;\n      } else {\n        console.warn(\"cannot find this story name\", storyId);\n        name = \"No Name\";\n      }\n\n      const clickHandle = createClickHandel({\n        calendarId: MY_CALENDAR_ID,\n        story,\n      });\n\n      const nameElement = document.createElement(\"i\");\n      nameElement.innerHTML = name + \" \"; // NOTE: space is for design, so not good way\n\n      const buttonElement = document.createElement(\"button\");\n      buttonElement.innerHTML = \"copy\";\n      buttonElement.onclick = clickHandle;\n\n      const arrayOfDomNodes = [nameElement, buttonElement];\n      return { domNodes: arrayOfDomNodes };\n    },\n    [calendar, createClickHandel]\n  );\n\n  return { resourceGroupLabelContent };\n};\n","import React from'react';\n\nexport const useModal = (init?: boolean) => {\n  const [isOpen, setIsOpen] = React.useState(!!init)\n\n  const open = React.useCallback(() => {\n    setIsOpen(true);\n  }, []);\n\n  const close = React.useCallback(() => {\n    setIsOpen(false);\n  }, []);\n\n  const toggle = React.useCallback(() => {\n    setIsOpen(prev => !prev)\n  }, []);\n\n  return {isOpen, open, close, toggle}\n}","import React from \"react\";\nimport styled from \"styled-components\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport { UserCalendarContainer } from \"../molecules/UserCalendarContainer\";\nimport { TemplateCalendarContainer } from \"../molecules/TemplateCalendarContainer\";\nimport { useModal } from \"../../hooks/useModal\";\n\nexport function CalendarList() {\n  const {\n    open: openCommunityCollege,\n    close: closeCommunityCollege,\n    isOpen: isOpenCommunityCollege,\n  } = useModal();\n\n  return (\n    <>\n      <Container>\n        <div>\n          <h2>Templates</h2>\n          <button onClick={openCommunityCollege}>Private College</button>\n          <button>TODO: Public College</button>\n          <button>TODO: ESL</button>\n        </div>\n        <hr />\n        <div>\n          <h2>User Calendar</h2>\n          <UserCalendarContainer />\n        </div>\n      </Container>\n\n      {/* Modal */}\n      <Dialog\n        fullScreen\n        open={isOpenCommunityCollege}\n        onClose={closeCommunityCollege}\n      >\n        <button onClick={closeCommunityCollege}>Close</button>\n        <TemplateCalendarContainer />\n      </Dialog>\n    </>\n  );\n}\n\nconst Container = styled.div`\n  display: grid;\n  gap: 1rem;\n`;\n","import React from 'react'\nimport styled from 'styled-components';\n\nexport function LogoImage(){\n  return(\n    <Img src={process.env.PUBLIC_URL + '/logo457_transparent.png'} alt=\"img\" />\n  )\n}\n\nconst Img = styled.img`\n  display: inline-block;\n  height: 100%;\n  object-fit: contain;\n  background: white;\n  padding: .3rem;\n`","import React from \"react\";\nimport styled from \"styled-components\";\nimport { LogoImage } from \"../atoms/LogoImage\";\n\nconst THIS_GITHUB_URL =\n  \"https://github.com/snamiki1212/canada-immigration-scheduler\";\n\nexport function Footer() {\n  return (\n    <Container>\n      <LogoText>\n        <LogoImageContainer>\n\n        <LogoImage />\n        </LogoImageContainer>\n        <span>Plangoab</span>\n      </LogoText>\n      <a href={THIS_GITHUB_URL} target=\"_blank\" rel=\"noreferrer\">\n        Github\n      </a>\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  padding: 5rem;\n  min-height: 30vh;\n  background: var(--main-color);\n  color: white;\n`;\n\nconst LogoImageContainer = styled.div`\n  height: 4rem;\n  width: 4rem;\n`\n\nconst LogoText = styled.div`\n  display: flex;\n  color: white;\n  font-size: 4rem;\n`;\n","import React from \"react\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport Typography from \"@material-ui/core/Typography\";\n\ntype Props = {\n  isOpen: boolean;\n  onClose: () => void;\n};\n\nexport function AboutModal({ isOpen, onClose }: Props) {\n  return (\n    <Dialog onClose={onClose} open={isOpen}>\n      <DialogTitle>About Plangoab</DialogTitle>\n      <DialogContent dividers={true}>\n        <Typography>this is content</Typography>\n        <Typography>this is content</Typography>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport styled from \"styled-components\";\nimport { AboutModal } from \"../atoms/AboutModal\";\nimport { LogoImage } from \"../atoms/LogoImage\";\nimport { useModal } from '../../hooks/useModal'\n\nexport function Header() {\n  const {isOpen, open, close} = useModal()\n\n  return (\n    <>\n      <Container>\n        <LogoImage />\n        <Title>Plangoab</Title>\n        <ButtonContainer>\n          <Button onClick={open}>About Plangoab</Button>\n        </ButtonContainer>\n      </Container>\n\n      {/* Modal */}\n      <AboutModal isOpen={isOpen} onClose={close} />\n    </>\n  );\n}\n\nconst Container = styled.div`\n  display: flex;\n  align-items: center;\n  height: 6rem;\n  background: var(--main-color);\n  padding: 1rem;\n`;\n\nconst Title = styled.span`\n  color: white;\n  font-size: 3rem;\n  padding: 1rem;\n`;\n\nconst ButtonContainer = styled.div`\n  margin-left: auto;\n`\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ProfileCard } from \"../organisms/ProfileCard\";\nimport { CalendarList } from \"../organisms/CalendarList\";\nimport { Footer } from \"../molecules/Footer\";\nimport { Header } from \"../molecules/Header\";\n\nexport function CalendarPage() {\n  return (\n    <Container>\n      <Header />\n      <ContentWrapper>\n        <ProfileCard />\n        <CalendarList />\n      </ContentWrapper>\n      <Footer />\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 2rem;\n`;\n\nconst ContentWrapper = styled.div`\n  padding: 0 3rem;\n  display: grid;\n  gap: 5rem;\n`;\n","import React from \"react\";\nimport { MuiPickersUtilsProvider } from \"./providers/MuiPickersUtilsProvider\";\nimport { CalendarPage } from \"./components/pages/CalendarPage\";\nimport './reset.css';\nimport './core.css';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <MuiPickersUtilsProvider>\n        <CalendarPage />\n      </MuiPickersUtilsProvider>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { combineReducers } from \"@reduxjs/toolkit\";\n\nimport userReducer from \"./features/user\";\nimport templateCalendarTableReducer from \"./features/templateCalendarTable\";\nimport userCalendarsReducer from \"./features/userCalendars\";\nimport resourceModalReducer from \"./ui/resourceModal\";\nimport eventModalReducer from \"./ui/eventModal\";\nimport storyModalReducer from \"./ui/storyModal\";\n\nconst uiReducer = combineReducers({\n  resourceModal: resourceModalReducer,\n  storyModal: storyModalReducer,\n  eventModal: eventModalReducer,\n});\n\nconst featuresReducer = combineReducers({\n  templateCalendar: templateCalendarTableReducer,\n  userCalendars: userCalendarsReducer,\n  user: userReducer,\n});\n\nconst rootReducer = combineReducers({\n  features: featuresReducer,\n  ui: uiReducer,\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\n\nexport default rootReducer;\n","import { configureStore } from \"@reduxjs/toolkit\";\nimport rootReducer from \"./rootReducer\";\n\nconst store = configureStore({\n  reducer: rootReducer,\n});\n\nif (process.env.NODE_ENV === \"development\" && module.hot) {\n  module.hot.accept(\"./rootReducer\", () => {\n    const newRootReducer = require(\"./rootReducer\").default;\n    store.replaceReducer(newRootReducer);\n  });\n}\n\nexport type AppDispatch = typeof store.dispatch;\n\nexport default store;\n","import React, { PropsWithChildren } from \"react\";\nimport { Provider } from \"react-redux\";\nimport store from \"../redux/store\";\n\nexport function ReactReduxProvider<T>({ children }: PropsWithChildren<T>) {\n  return <Provider store={store}>{children}</Provider>;\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { ReactReduxProvider } from './providers/ReactReduxProvider'\n\nconst render = () => {\n  ReactDOM.render(\n    <React.StrictMode>\n      <ReactReduxProvider>\n        <App />\n      </ReactReduxProvider>\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n  );\n};\n\nrender();\n\n// for redux\nif (process.env.NODE_ENV === \"development\" && module.hot) {\n  module.hot.accept(\"./App\", render);\n}\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.warn))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}